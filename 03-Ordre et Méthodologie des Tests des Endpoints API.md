---
# **Ordre et M√©thodologie des Tests des Endpoints API**
---

# 1 - Liste des endpoints

```ssh
+-------+---------+------------------------------------------------+------------------------------------------+
| Ordre | M√©thode |                  Endpoint                     |               Description                |
+-------+---------+------------------------------------------------+------------------------------------------+
|   1   |  POST   | /api/v1/auth/user/register                     | Inscription utilisateur                  |
|   2   |   PUT   | /api/v1/auth/validateAccount/{verificationCode} | Validation de l'email                    |
|   3   |  POST   | /api/v1/auth/token                              | Connexion utilisateur                    |
|   4   |  POST   | /api/v1/auth/admin/register                     | Inscription administrateur               |
|   5   |   PUT   | /api/v1/auth/validateAccount/{verificationCode} | Validation administrateur                |
|   6   |  POST   | /api/v1/auth/token                              | Connexion administrateur                 |
|   7   | DELETE  | /api/v1/auth/deleteUser                         | Suppression d'un compte                  |
|   8   |   GET   | /api/v1/auth/userinsesson                       | V√©rification de l'utilisateur en session |
|   9   |  POST   | /api/v1/auth/updateAccount                      | Mise √† jour du compte                    |
|  10   |  POST   | /api/v1/auth/forgotPassword                     | Demande de r√©initialisation du mot de passe |
|  11   |   PUT   | /api/v1/auth/resetPassword/{token}              | R√©initialisation de mot de passe         |
|  12   |  POST   | /api/v1/auth/addUserByAdmin                     | Ajout d'un utilisateur par un admin      |
|  13   |  POST   | /api/v1/plan/add                                | Ajout d'un plan                          |
|  14   |   PUT   | /api/v1/plan/update/{id}                        | Mise √† jour d'un plan                    |
|  15   |   PUT   | /api/v1/plan/delete/{id}                        | Suppression d'un plan                    |
|  16   |   GET   | /api/v1/plan/all                                | R√©cup√©ration de tous les plans           |
|  17   |  POST   | /api/v1/payment/create                          | Cr√©ation d'un paiement                   |
|  18   |  POST   | /api/v1/payment/confirm                         | Confirmation d'un paiement               |
|  19   |  POST   | /api/v1/auth/user/registerBySubscription        | Inscription via abonnement               |
|  20   |  POST   | /api/v1/auth/loginGoogle                        | Connexion via Google                     |
|  21   |  POST   | /api/v1/auth/logout                             | D√©connexion utilisateur                  |
|  22   |  POST   | /api/v1/auth/admin/logout                       | D√©connexion administrateur               |
|  23   |   PUT   | /api/v1/auth/user/resendVerification            | Renvoyer l'email de v√©rification         |
|  24   |   PUT   | /api/v1/auth/user/disableAccount                | D√©sactivation du compte utilisateur      |
|  25   |  POST   | /api/v1/auth/user/reactivateAccount             | R√©activation du compte utilisateur       |
|  26   |   PUT   | /api/v1/auth/user/changePassword                | Changement de mot de passe               |
|  27   |  POST   | /api/v1/auth/user/updateEmail                   | Mise √† jour de l'email utilisateur       |
|  28   |   PUT   | /api/v1/auth/admin/manageUsers                  | Gestion des utilisateurs par l'admin     |
|  29   |   PUT   | /api/v1/auth/admin/assignRole                   | Assignation de r√¥le                      |
|  30   |   PUT   | /api/v1/auth/admin/revokeRole                   | R√©vocation de r√¥le                       |
+-------+---------+------------------------------------------------+------------------------------------------+
```










# **Pourquoi un ordre pr√©cis pour les tests ?**
- L‚Äôobjectif est de garantir que chaque fonctionnalit√© fonctionne correctement avant de passer √† la suivante. 
- Tester les endpoints dans le bon ordre permet de :  

- **√âviter les erreurs bloquantes** en validant d'abord l'authentification.  
- **Assurer la coh√©rence des donn√©es** en testant progressivement la gestion des comptes et des plans.  
- **Faciliter le d√©bogage** en isolant les erreurs √† chaque √©tape.  
- **Garantir un parcours utilisateur fluide** pour les fonctionnalit√©s comme l‚Äôinscription, la gestion des abonnements et le paiement.  

### **Outils requis pour les tests**
Avant de commencer, assurez-vous d‚Äôavoir :  
- **Swagger** pour tester les endpoints REST API.  
- **Postman (optionnel)** pour tester des cas avanc√©s.  
- **Base de donn√©es accessible** pour v√©rifier les changements d‚Äô√©tat des utilisateurs et des plans.  
- **Navigateur et outils de d√©veloppement (F12)** pour tester l‚Äôint√©gration du localStorage et l‚Äôauthentification.  

---
# **Ordre des Tests et M√©thodologie**
---

Chaque test doit √™tre effectu√© avec Swagger **avant** de d√©velopper l‚Äôinterface.  

### **1. Authentification et Gestion des Comptes** (Tester en premier)  
üí° *Pourquoi ?*  
Sans authentification, il est impossible d‚Äôacc√©der aux autres fonctionnalit√©s s√©curis√©es.  

#### **√âtape 1 : Tester l‚Äôinscription et la connexion pour un utilisateur normal**
1. **POST** `/api/v1/auth/user/register` ‚Äì Cr√©er un utilisateur normal.  
   - Envoyez les donn√©es requises (email, mot de passe, etc.).  
   - V√©rifiez dans la base de donn√©es que l'utilisateur est bien enregistr√©.  
2. **PUT** `/api/v1/auth/validateAccount/{verificationCode}` ‚Äì V√©rifier le compte.  
   - Utilisez le code re√ßu par email pour activer le compte.  
   - V√©rifiez que `is_validated = true` en base de donn√©es.  
3. **POST** `/api/v1/auth/token` ‚Äì Connexion de l‚Äôutilisateur.  
   - Utilisez les identifiants pour r√©cup√©rer un token d‚Äôauthentification.  
   - **Stockez le token** dans le `localStorage` (via les outils du navigateur).  

#### **√âtape 2 : Tester l‚Äôinscription et la connexion d‚Äôun administrateur**
1. **POST** `/api/v1/auth/admin/register` ‚Äì Inscrire un administrateur.  
2. Modifier **manuellement** en base de donn√©es `is_validated = true`.  
3. **POST** `/api/v1/auth/token` ‚Äì Connexion de l‚Äôadmin.  
   - V√©rifiez que le token est bien g√©n√©r√©.  
4. **(Optionnel)** **PUT** `/api/v1/auth/validateAccount/{verificationCode}` ‚Äì Si la validation admin est requise, tester cette API.  
5. **Ajout du superadmin** (MOHSEN1) : S'assurer que l'email `haythemrehouma@gmail.com` peut valider les administrateurs.  

---

### **2. Impl√©mentation du Logout**
üí° *Pourquoi ?*  
Sans logout, les utilisateurs restent connect√©s ind√©finiment et les tests d‚Äôauthentification ne seront pas fiables.  

**M√©thode de test :**  
1. **Supprimer le token du localStorage.**  
2. V√©rifier que l‚Äôutilisateur n‚Äôa plus acc√®s aux pages s√©curis√©es.  
3. Ajouter un **bouton de d√©connexion** sur l‚Äôinterface.  

---

### **3. Connexion en tant qu‚ÄôAdministrateur**
üí° *Pourquoi ?*  
L‚Äôadmin doit √™tre authentifi√© pour g√©rer les plans.  

1. Se connecter avec l‚Äôadmin via **POST** `/api/v1/auth/token`.  
2. V√©rifier que les routes prot√©g√©es de l‚Äôadmin sont bien accessibles.  

---

### **4. Gestion des Plans** (Tester apr√®s l‚Äôauthentification)
üí° *Pourquoi ?*  
L‚Äôutilisateur doit √™tre connect√© avant de g√©rer ses plans d‚Äôabonnement.  

#### **M√©thode de test :**
1. **POST** `/api/v1/plan/add` ‚Äì Ajouter un plan.  
   - V√©rifier la cr√©ation en base de donn√©es.  
2. **PUT** `/api/v1/plan/update/{id}` ‚Äì Modifier un plan.  
   - Tester avec des valeurs diff√©rentes et valider la mise √† jour.  
3. **PUT** `/api/v1/plan/delete/{id}` ‚Äì Supprimer un plan.  
   - V√©rifier que le plan est bien supprim√© en base de donn√©es.  

#### **MOHSEN2 : Impl√©mentation de la r√©cup√©ration des plans**
4. **GET** `/api/v1/plan/all` ‚Äì R√©cup√©rer les plans disponibles.  
   - V√©rifier que l‚ÄôAPI retourne bien la liste des plans.  
   - Impl√©menter une interface permettant d‚Äôafficher ces plans (administrateur uniquement).  

---

### **5. Consultation de la Landing Page et Tarification**
üí° *Pourquoi ?*  
Un utilisateur non connect√© doit pouvoir consulter les tarifs avant de souscrire.  

#### **M√©thode de test :**
1. V√©rifier que la **Landing Page** affiche les tarifs r√©cup√©r√©s via **GET** `/api/v1/plan/all`.  
2. Ajouter un bouton pour souscrire √† un plan.  

---

### **6. Gestion des Paiements** (Tester en dernier)
üí° *Pourquoi ?*  
Le paiement d√©pend des comptes et des plans. Il faut donc les tester en dernier.  

#### **M√©thode de test :**
1. **POST** `/api/v1/payment/create` ‚Äì Cr√©er un paiement.  
   - V√©rifier que le paiement est bien enregistr√© en base de donn√©es.  
2. **POST** `/api/v1/payment/confirm` ‚Äì Confirmer un paiement.  
   - V√©rifier que l‚Äô√©tat du paiement passe √† "Confirm√©".  

‚ö† **V√©rification importante :**  
- V√©rifier que la **r√©f√©rence du plan choisi** est bien envoy√©e au backend.  
- Simuler un cas d‚Äô√©chec (exemple : paiement refus√©) et voir comment l‚ÄôAPI r√©agit.  

---

### **7. Inscription via un Abonnement**
üí° *Pourquoi ?*  
Un utilisateur peut s‚Äôinscrire directement en souscrivant √† un plan.  

#### **M√©thode de test :**
1. **POST** `/api/v1/auth/user/registerBySubscription` ‚Äì Inscription avec abonnement.  
   - V√©rifier que l‚Äôutilisateur est bien enregistr√© et li√© √† un plan.  
   - Confirmer que le token de souscription est bien utilis√©.  

#### **MOHSEN3 : Cas particulier**
2. G√©rer le **renouvellement d‚Äôabonnement** pour un utilisateur d√©j√† inscrit.  
3. Ajouter une gestion des remboursements (**refund**).  

---

### **8. Autres Fonctionnalit√©s**
üí° *Pourquoi ?*  
Ces fonctionnalit√©s permettent d‚Äôam√©liorer l‚Äôexp√©rience utilisateur.  

#### **Validation et Gestion du Compte**
- **GET** `/api/v1/auth/userinsesson` ‚Äì V√©rifier l‚Äôutilisateur en session.  
- **PUT** `/api/v1/auth/updateAccount` ‚Äì Modifier un compte utilisateur.  
- **POST** `/api/v1/auth/forgotPassword` ‚Äì R√©initialisation du mot de passe (sans login).  
- **PUT** `/api/v1/auth/resetPassword/{token}` ‚Äì R√©initialiser avec un token.  
- **PUT** `/api/v1/auth/deleteUser` ‚Äì Suppression d‚Äôun compte (admin uniquement).  

#### **Gestion par un Administrateur**
- **POST** `/api/v1/auth/addUserByAdmin` ‚Äì Ajouter un utilisateur depuis l‚Äôinterface admin.  

---

### **9. Connexion via Google**
üí° *Pourquoi ?*  
Certains utilisateurs peuvent vouloir se connecter sans cr√©er de compte.  

- **POST** `/api/v1/auth/loginGoogle` ‚Äì Tester la connexion via Google.  
- V√©rifier que le compte est bien cr√©√© apr√®s la premi√®re connexion.  

---

## **R√©sum√© de la Strat√©gie de Test**
1. **Tester l‚Äôauthentification en premier**, car elle conditionne l‚Äôacc√®s aux autres fonctionnalit√©s.  
2. **Tester la gestion des comptes** (modification, r√©cup√©ration de mot de passe).  
3. **Tester la gestion des plans** apr√®s l‚Äôauthentification.  
4. **Enfin, tester les paiements**, car ils d√©pendent des plans et de l‚Äôauthentification.  

Ce processus garantit des tests progressifs et efficaces, facilitant l‚Äôidentification des erreurs √† chaque √©tape.



